chat aula dia 20 

[19:50] Formador 46

# ASP.NET Core (.NET Framework)

# Build and test ASP.NET Core projects targeting the full .NET Framework.

# Add steps that publish symbols, save build artifacts, and more:

# https://docs.microsoft.com/azure/devops/pipelines/languages/dotnet-core




trigger:

- main




pool:

  vmImage: 'ubuntu-latest'




variables:

  solution: '**/*.sln'

  web: '**/WebAppPipeline/WebAppPipeline.csproj'

  lib: '**/Lib/Lib.csproj'

  unittests: '**/UnitTesting/UnitTesting.csproj'

  functionaltests: '**/FunctionalTesting/FunctionalTesting.csproj'

  integrationtest: '**/IntegrationTesting/IntegrationTesting.csproj'

  buildPlatform: 'Any CPU'

  buildConfiguration: 'Release'

  azuresubscrition: 'DevOpsWebApp'

  appName: 'devops1'

  containerregistryName: ''

  artifactName: 'WebAppRelease'




steps:

- task: NuGetToolInstaller@1




- task: DotNetCoreCLI@2

  inputs:

    displayName: Restore Lib dependencies

    command: 'restore'

    projects: '$(lib)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Buid Lib

    command: 'build'

    projects: '$(lib)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Unit tests on Lib

    command: 'test'

    projects: '$(unittests)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Restore Web dependencies

    command: 'restore'

    projects: '$(web)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Buid Web

    command: 'build'

    projects: '$(web)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Functional tests on Web

    command: 'test'

    projects: '$(functionaltests)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Integration tests on Web

    command: 'test'

    projects: '$(integrationtest)'

- task: DotNetCoreCLI@2

  inputs:

    displayName: Publish

    command: 'publish'

    publishWebProjects: true

    arguments: '--configuration $(buildConfiguration) --output $(Build.ArtifactStagingDirectory)'

    zipAfterPublish: true




- task: PublishBuildArtifacts@1

  inputs:

    displayName: Publish Artifacts

    PathtoPublish: '$(Build.ArtifactStagingDirectory)'

    ArtifactName: '$(artifactName)'




- task: AzureWebApp@1

  inputs:

    displayName: Deploy para Azure

    azureSubscription: '$(azuresubscrition)'

    appType: 'webApp'

    appName: '$(appName)'

    package: '$(System.ArtifactsDirectory)/**/*.zip'

    runtimeStack: 'DOTNETCORE|6.0'

Build, test, and deploy .NET Core apps - Azure Pipelines

Use .NET Core to build apps with Azure Pipelines, Azure DevOps, & Team Foundation Server.
-> https://learn.microsoft.com/en-gb/azure/devops/pipelines/ecosystems/dotnet-core?view=azure-devops&tabs=dotnetfive